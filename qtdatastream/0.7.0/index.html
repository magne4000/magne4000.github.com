<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Home - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav class="nav">
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-qtdatastream.html">qtdatastream</a><ul class='methods'><li data-type='method'><a href="module-qtdatastream.html#.getUserType">getUserType</a></li><li data-type='method'><a href="module-qtdatastream.html#.isUserTypeComplex">isUserTypeComplex</a></li><li data-type='method'><a href="module-qtdatastream.html#.registerUserType">registerUserType</a></li></ul></li><li><a href="module-qtdatastream_reader.html">qtdatastream/reader</a></li><li><a href="module-qtdatastream_writer.html">qtdatastream/writer</a></li></ul><h3>Classes</h3><ul><li><a href="module-qtdatastream.Socket.html">Socket</a><ul class='methods'><li data-type='method'><a href="module-qtdatastream.Socket.html#updateSocket">updateSocket</a></li><li data-type='method'><a href="module-qtdatastream.Socket.html#write">write</a></li></ul></li><li><a href="module-qtdatastream_reader-Reader.html">Reader</a><ul class='methods'><li data-type='method'><a href="module-qtdatastream_reader-Reader.html#.conv">conv</a></li><li data-type='method'><a href="module-qtdatastream_reader-Reader.html#getBool">getBool</a></li><li data-type='method'><a href="module-qtdatastream_reader-Reader.html#getByteArray">getByteArray</a></li><li data-type='method'><a href="module-qtdatastream_reader-Reader.html#getChar">getChar</a></li><li data-type='method'><a href="module-qtdatastream_reader-Reader.html#getDateTime">getDateTime</a></li><li data-type='method'><a href="module-qtdatastream_reader-Reader.html#getDouble">getDouble</a></li><li data-type='method'><a href="module-qtdatastream_reader-Reader.html#getInt">getInt</a></li><li data-type='method'><a href="module-qtdatastream_reader-Reader.html#getInt64">getInt64</a></li><li data-type='method'><a href="module-qtdatastream_reader-Reader.html#getList">getList</a></li><li data-type='method'><a href="module-qtdatastream_reader-Reader.html#getMap">getMap</a></li><li data-type='method'><a href="module-qtdatastream_reader-Reader.html#getQVariant">getQVariant</a></li><li data-type='method'><a href="module-qtdatastream_reader-Reader.html#getQVariantByType">getQVariantByType</a></li><li data-type='method'><a href="module-qtdatastream_reader-Reader.html#getQVariantType">getQVariantType</a></li><li data-type='method'><a href="module-qtdatastream_reader-Reader.html#getShort">getShort</a></li><li data-type='method'><a href="module-qtdatastream_reader-Reader.html#getString">getString</a></li><li data-type='method'><a href="module-qtdatastream_reader-Reader.html#getStringList">getStringList</a></li><li data-type='method'><a href="module-qtdatastream_reader-Reader.html#getTime">getTime</a></li><li data-type='method'><a href="module-qtdatastream_reader-Reader.html#getUInt">getUInt</a></li><li data-type='method'><a href="module-qtdatastream_reader-Reader.html#getUInt64">getUInt64</a></li><li data-type='method'><a href="module-qtdatastream_reader-Reader.html#parse">parse</a></li></ul></li><li><a href="module-qtdatastream_writer-Writer.html">Writer</a><ul class='methods'><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#.conv">conv</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#_parse">_parse</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#_parse_bool">_parse_bool</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#_parse_class">_parse_class</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#_parse_qbytearray">_parse_qbytearray</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#_parse_qchar">_parse_qchar</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#_parse_qdatetime">_parse_qdatetime</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#_parse_qdouble">_parse_qdouble</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#_parse_qint">_parse_qint</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#_parse_qint64">_parse_qint64</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#_parse_qinvalid">_parse_qinvalid</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#_parse_qlist">_parse_qlist</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#_parse_qmap">_parse_qmap</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#_parse_qshort">_parse_qshort</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#_parse_qstring">_parse_qstring</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#_parse_qstringlist">_parse_qstringlist</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#_parse_quint">_parse_quint</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#_parse_quint64">_parse_quint64</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#_parse_qusertype">_parse_qusertype</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#_parse_qvariant">_parse_qvariant</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#getBuffer">getBuffer</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#getRawBuffer">getRawBuffer</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#parse">parse</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#write">write</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#writeBool">writeBool</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#writeByteArray">writeByteArray</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#writeChar">writeChar</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#writeDateTime">writeDateTime</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#writeDouble">writeDouble</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#writeInt">writeInt</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#writeInt64">writeInt64</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#writeQVariant">writeQVariant</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#writeShort">writeShort</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#writeString">writeString</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#writeUInt">writeUInt</a></li><li data-type='method'><a href="module-qtdatastream_writer-Writer.html#writeUInt64">writeUInt64</a></li></ul></li><li><a href="module-qtdatastream-QBool.html">QBool</a></li><li><a href="module-qtdatastream-QByteArray.html">QByteArray</a></li><li><a href="module-qtdatastream-QChar.html">QChar</a></li><li><a href="module-qtdatastream-QDateTime.html">QDateTime</a></li><li><a href="module-qtdatastream-QDouble.html">QDouble</a></li><li><a href="module-qtdatastream-QInt.html">QInt</a></li><li><a href="module-qtdatastream-QInt64.html">QInt64</a></li><li><a href="module-qtdatastream-QInvalid.html">QInvalid</a></li><li><a href="module-qtdatastream-QList.html">QList</a></li><li><a href="module-qtdatastream-QMap.html">QMap</a></li><li><a href="module-qtdatastream-QShort.html">QShort</a></li><li><a href="module-qtdatastream-QString.html">QString</a></li><li><a href="module-qtdatastream-QStringList.html">QStringList</a></li><li><a href="module-qtdatastream-QTime.html">QTime</a></li><li><a href="module-qtdatastream-QUInt.html">QUInt</a></li><li><a href="module-qtdatastream-QUInt64.html">QUInt64</a></li><li><a href="module-qtdatastream-QUserType.html">QUserType</a></li><li><a href="module-qtdatastream-QVariant.html">QVariant</a></li></ul>
</nav>

<div id="main">
    

    <!--container.tmpl-->




    









    


    <section class="readme">
        <article><h1>node-qtdatastream</h1><p>Nodejs lib which can read/write Qt formatted Datastreams.</p>
<p>For the moment the following types are handled for reading and writing:
  QBool, QShort, QInt, QInt64, QUInt, QUInt64, QDouble, QMap, QList, QString, QVariant, QStringList, QByteArray, QUserType, QDateTime, QTime, QChar, QInvalid</p>
<h2>Getting Started</h2><p>Install the module with <code>npm install node-qtdatastream --production</code>,
or <code>npm install node-qtdatastream</code> for development purpose.</p>
<h2>Documentation</h2><p><a href="http://magne4000.github.io/qtdatastream/0.7.0/">Technical documentation</a></p>
<h3>Type inference</h3><p>Javascript types are automatically converted to Qt Types, and vice versa.</p>
<p>By Writer:</p>
<ul>
<li>string -&gt; QString</li>
<li>number -&gt; QUInt</li>
<li>boolean -&gt; QBool</li>
<li>Array -&gt; QList&lt;QVariant&lt;?&gt;&gt;</li>
<li>Date -&gt; QDateTime</li>
<li>Object -&gt; QMap&lt;QString, QVariant&lt;?&gt;&gt;</li>
<li>Q*** -&gt; Q***</li>
</ul>
<p>By Reader:</p>
<ul>
<li>QString -&gt; string</li>
<li>QUInt -&gt; number</li>
<li>QInt -&gt; number</li>
<li>QUInt64 -&gt; number</li>
<li>QInt64 -&gt; number</li>
<li>QDouble -&gt; number</li>
<li>QShort -&gt; number</li>
<li>QBool -&gt; number</li>
<li>QList -&gt; Array</li>
<li>QStringList -&gt; Array&lt;string&gt;</li>
<li>QByteArray -&gt; Buffer</li>
<li>QMap -&gt; Object</li>
<li>QUserType -&gt; Object</li>
<li>QDateTime -&gt; Date</li>
<li>QTime -&gt; number</li>
<li>QChar -&gt; string</li>
<li>QInvalid -&gt; undefined</li>
</ul>
<h4>QUserType special treatment</h4><p>QUserType are special types defined by user (QVariant::UserType).</p>
<p>QUserType are defined like this <code>&lt;size:uint32&gt;&lt;bytearray of size&gt;</code>. bytearray
can be casted to string (but it is not a string as intended by Qt,
because it is UTF8 and not UTF16) : <code>bytearray.toString()</code>. The resulting string
is the QUserType key.</p>
<h5>Reader</h5><p>The Reader use an internal mechanism to know which parser must be used for each
QUserType, they are defined like this :</p>
<pre class="prettyprint source lang-javascript"><code>qtdatastream.registerUserType(&quot;NetworkId&quot;, qtdatastream.Types.INT); //NetworkId here is our key</code></pre><p>This tell the reader to decode <code>NetworkId</code> bytearray like and INT. But those
structures can be much more complicated :</p>
<pre class="prettyprint source lang-javascript"><code>qtdatastream.registerUserType(&quot;BufferInfo&quot;, [
    {id: qtdatastream.Types.INT},
    {network: qtdatastream.Types.INT},
    {type: qtdatastream.Types.SHORT},
    {group: qtdatastream.Types.INT},
    {name: qtdatastream.Types.BYTEARRAY}
]);</code></pre><p>The bytearray corresponding to this structure look like this :</p>
<pre class="prettyprint source"><code>  &lt;int32>&lt;int32>&lt;int16>&lt;int32>&lt;qbytearray></code></pre><p>The whole new type will be put in a new Object, the <code>id</code> key will contain the first
&lt;int32&gt;, the <code>network</code> key will contain the second &lt;int32&gt;, etc.
The definition is contained into an array to force a parsing order (here, <code>id</code> will
always be the first &lt;int32&gt; block).</p>
<p>UserTypes can also be nested, by specifying the USERTYPE name instead of Qt type :</p>
<pre class="prettyprint source lang-javascript"><code>qtdatastream.registerUserType(&quot;BufferInfoContainer&quot;, [
    {id: qtdatastream.Types.INT},
    {bufferInfo: &quot;BufferInfo&quot;}
]);</code></pre><h5>Writer</h5><p>Custom UserTypes must be defined as in Reader, with the help of <code>qtdatastream.registerUserType</code> method.</p>
<p>Writing UserType is done as follow:</p>
<pre class="prettyprint source lang-javascript"><code>new Writer({
    &quot;BufferInfo&quot;: new QUserType(&quot;BufferInfo&quot;, {
        id: 2,
        network: 4,
        type: 5,
        group: 1,
        name: &quot;BufferInfo2&quot;
    })
});</code></pre><p>See test folder for details.</p>
<h2>Examples</h2><h3>Basic usage</h3><pre class="prettyprint source lang-javascript"><code>var net = require('net'),
    qtdatastream = require('qtdatastream'),
    QtSocket = qtdatastream.Socket;
var client = net.Socket();

// Connect to a Qt socket
// and write something into the socket
client.connect(65000, &quot;domain.tld&quot;, function(){
    var qtsocket = new QtSocket(client);

    // Here data is the already parsed response
    qtsocket.on('data', function(data) {
        //...
    });

    // Write something to the socket
    qtsocket.write({
        &quot;AString&quot;: &quot;BString&quot;,
        &quot;CString&quot;: 42
    });
});</code></pre><h3>Extended usage</h3><pre class="prettyprint source lang-javascript"><code>var net = require('net'),
    Writer = require('qtdatastream').Writer,
    Reader = require('qtdatastream').Reader;
var client = net.Socket();

// Connect to a Qt socket
// and write something into the socket
client.connect(65000, &quot;domain.tld&quot;, function(){
    var writer = new Writer({
        &quot;AString&quot;: new QVariant(new QString(&quot;BString&quot;)),
        &quot;CString&quot;: new QVariant(new QUInt(42))
    });
    client.write(writer.getBuffer());
});

client.on('data', function(data) {
    var reader = new Reader(data);
    var parsedData = data.parse();
    //...
});

//NB: It is not advisable to use net.Socket directly because buffers are received
//in chunks. Using qtdatastream.Socket allows to ignore this. Moreover, its parses
//automatically the buffers.</code></pre><h2>Debugging</h2><p>Debug mode can be activated by setting environment variable DEBUG in your shell before launching your program:</p>
<pre class="prettyprint source"><code>export DEBUG=&quot;qtdatastream:*&quot;</code></pre><h2>License</h2><p>Copyright (c) 2014-2016 Joël Charles<br>Licensed under the MIT license.</p></article>
    </section>






</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Tue Feb 07 2017 10:40:24 GMT+0100 (CET) using the LOKE theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>